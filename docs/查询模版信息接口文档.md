# DescribeFlowTemplates - 查询模板信息

> 官方文档：https://qian.tencent.com/developers/companyApis/templatesAndFiles/DescribeFlowTemplates

## 适用场景

该接口常用来配合"模板发起合同-创建电子文档"接口，作为创建电子文档的**前置接口**使用。

通过此接口查询到模板信息后，再通过调用创建电子文档接口，指定模板ID，指定模板中需要的填写控件内容等，完成电子文档的创建。

## 请求参数

### 通过模板ID查询

| 参数 | 说明 | 示例值 |
|------|------|--------|
| Filters[0].Key | 过滤条件键 | `template-id` |
| Filters[0].Values | 模板ID | `yDRS4UUgygqdcjjhUuO4zjEBpXdcsHWX` |
| Limit | 返回条数上限 | `20` |

## 返回数据结构

### 主要字段

| 字段 | 类型 | 说明 |
|------|------|------|
| `TemplateId` | String | 模板唯一标识 |
| `TemplateName` | String | 模板名称 |
| `Description` | String | 模板描述 |
| `Status` | Integer | 模板状态（1=正常） |
| `Published` | Boolean | 是否已发布 |
| `CreatedOn` | Integer | 创建时间戳 |
| `Creator` | String | 创建人姓名 |
| `CreatorId` | String | 创建人ID |
| `OrganizationId` | String | 所属企业ID |
| `TemplateVersion` | String | 模板版本号 |

### 文件信息 (FileInfos)

| 字段 | 说明 |
|------|------|
| `FileId` | 文件ID |
| `FileName` | 文件名称 |
| `FileSize` | 文件大小（字节） |
| `CreatedOn` | 创建时间戳 |

### 签署方信息 (Recipients)

| 字段 | 说明 |
|------|------|
| `RecipientId` | 签署方ID |
| `RecipientType` | 签署方类型 |
| `RoleName` | 角色名称（如"乙方"） |
| `RoutingOrder` | 签署顺序 |
| `ApproverSignTypes` | 支持的签署类型 |
| `ApproverVerifyTypes` | 支持的验证类型 |

**签署方类型 (RecipientType)**：
- `PROMOTER` - 发起人
- `ENTERPRISE` - 企业签署方
- `INDIVIDUAL` - 个人签署方

### 签署控件 (SignComponents)

| 字段 | 说明 |
|------|------|
| `ComponentId` | 控件ID |
| `ComponentName` | 控件名称 |
| `ComponentType` | 控件类型 |
| `ComponentPage` | 所在页码 |
| `ComponentPosX` | X坐标位置 |
| `ComponentPosY` | Y坐标位置 |
| `ComponentWidth` | 控件宽度 |
| `ComponentHeight` | 控件高度 |
| `ComponentRecipientId` | 关联的签署方ID |
| `ComponentRequired` | 是否必填 |

**签署控件类型 (ComponentType)**：
- `SIGN_SIGNATURE` - 个人签名/印章
- `SIGN_SEAL` - 企业印章
- `SIGN_DATE` - 签署日期

### 填写控件 (Components)

用于在发起合同时填充的表单字段，如：
- 乙方姓名
- 乙方电话
- 乙方身份证号
- 其他自定义字段

## 返回示例

```json
{
  "Response": {
    "RequestId": "s16951208061xxxx3957",
    "TotalCount": 1,
    "Templates": [
      {
        "TemplateId": "yDRS4UUgygqdcjjhUuO4zjEBpXdcsHWX",
        "TemplateName": "e2eTest-启停用模板_88433",
        "Status": 1,
        "Published": true,
        "CreatedOn": 1693967458,
        "Creator": "测试人",
        "FileInfos": [
          {
            "FileId": "yDwJ0UUckpk2079mUxgm9jJ8EZp3aAc0",
            "FileName": "test.pdf",
            "FileSize": 65259
          }
        ],
        "Recipients": [
          {
            "RecipientId": "yDwJ0UUckpk2077lUxgm9jJ9eZgZChJe",
            "RecipientType": "ENTERPRISE",
            "RoleName": "张三示例企业",
            "RoutingOrder": 1
          },
          {
            "RecipientId": "yDxZzUyKQDKuihUuO4zjEy09jfapyHjn",
            "RecipientType": "INDIVIDUAL",
            "RoleName": "乙方",
            "RoutingOrder": 2
          }
        ],
        "SignComponents": [
          {
            "ComponentId": "ComponentId_4",
            "ComponentName": "个人签名/印章",
            "ComponentType": "SIGN_SIGNATURE",
            "ComponentPage": 1
          },
          {
            "ComponentId": "ComponentId_7",
            "ComponentName": "企业印章",
            "ComponentType": "SIGN_SEAL",
            "ComponentPage": 1
          }
        ]
      }
    ]
  }
}
```

## 在本项目中的使用

### 查询脚本

项目中提供了 `scripts/get-template-fields.mjs` 脚本来调用此接口：

```bash
node scripts/get-template-fields.mjs
```

### 服务层调用

在 `src/services/esign.service.ts` 中封装了此接口的调用方法。

## 注意事项

1. **模板ID格式**：以 `yD` 开头的字符串
2. **签署顺序**：`RoutingOrder` 决定签署的先后顺序
3. **控件关联**：通过 `ComponentRecipientId` 将签署控件与签署方关联
4. **模板状态**：只有 `Published: true` 且 `Status: 1` 的模板才能用于发起合同
