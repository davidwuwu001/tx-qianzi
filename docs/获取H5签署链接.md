# 获取H5签署链接 (CreateFlowSignUrl)

腾讯电子签 API 接口文档

---

## 一、接口概述

- **接口请求域名**：`ess.tencentcloudapi.com`
- **接口名称**：`CreateFlowSignUrl`
- **接口版本**：`2020-11-11`
- **请求频率限制**：20次/秒

### 功能说明

该接口用于在发起合同后，生成用户的签署链接。

### 重要提示

- ⚠️ 签署链接有效期为 **30分钟**，过期后将失效，需重新创建
- 适用于 **APP集成** 场景，支持 APP 打开或浏览器直接打开
- **不支持** 微信小程序嵌入（小程序需参考微信官方文档配置）
- H5签署仅支持 **中国大陆身份证** 和 **中国港澳台居民居住证**
- APP嵌入H5需按照慧眼人脸核身兼容性文档做适配

---

## 二、输入参数

### 公共参数

| 参数名称 | 必选 | 类型 | 描述 |
|---------|------|------|------|
| Action | 是 | String | 固定值：`CreateFlowSignUrl` |
| Version | 是 | String | 固定值：`2020-11-11` |
| Region | 否 | String | 可选参数 |

### 业务参数

| 参数名称 | 必选 | 类型 | 描述 |
|---------|------|------|------|
| FlowId | 是 | String | 合同流程ID（32位字符串），可在控制台"合同中心"查看 |
| Operator | 否 | UserInfo | 执行操作的员工信息 |
| Agent | 否 | Agent | 代理企业和员工信息（集团代理子企业场景使用） |
| FlowApproverInfos.N | 否 | Array of FlowCreateApprover | 流程签署人列表 |
| VideoVerifyTimesLimit | 否 | Integer | 视频签署限制次数（1-10，默认5次） |
| JumpUrl | 否 | String | 签署完成后的跳转链接（最大1000字符） |
| UrlType | 否 | Integer | 链接类型：0-签署链接（默认），1-预览链接 |

### FlowApproverInfos 参数说明

必传字段：
- `ApproverName`：签署人姓名
- `ApproverMobile`：签署人手机号
- `ApproverType`：签署人类型
- `OrganizationName`：企业名称（企业签署人必传）

可选字段：
- `RecipientId`：发起合同返回的签署方ID
- `ApproverSignTypes`：指定签署认证方式（仅此链接生效）
- `SignTypeSelector`：认证校验方式选择模式
- `Intention`：H5签署视频核身意图配置

> **注意**：签署人只能使用手写签名、时间类型、印章类型、签批类型的签署控件和内容填写控件。

---

## 三、输出参数

| 参数名称 | 类型 | 描述 |
|---------|------|------|
| FlowApproverUrlInfos | Array of FlowApproverUrlInfo | 签署人签署链接信息 |
| RequestId | String | 唯一请求ID |

---

## 四、使用场景示例

### 1. 创建个人用户H5签署链接

发起流程后，给C端签署人创建签署链接。

### 2. 创建个人用户H5签署链接（重新指定认证方式）

指定签署时的认证方式为人脸和密码签署，认证方式仅此链接生效。

### 3. 创建企业用户H5预览链接

给B端签署人创建预览链接（UrlType=1）。

### 4. 创建合同发起方预览链接

给合同发起方创建预览链接，FlowApproverInfos 传空或不传。

### 5. 创建企业用户H5签署链接

给B端签署人创建签署链接。

### 6. 创建个人用户H5签署链接（视频认证）

使用视频认证方式创建签署链接。

### 7. 签署完成后跳转指定地址

设置 JumpUrl 参数，签署完成后跳转到指定页面。

---

## 五、错误码

| 错误码 | 描述 |
|-------|------|
| FailedOperation | 操作失败 |
| InternalError | 内部错误 |
| InternalError.Api | 第三方接口失败 |
| InvalidParameter | 参数错误 |
| MissingParameter | 缺少参数错误 |
| OperationDenied.ErrNoResourceAccess | 此企业无该资源使用权限 |
| OperationDenied.Forbid | 禁止此项操作 |
| OperationDenied.NoIdentityVerify | 未通过个人实名认证 |
| OperationDenied.NoLogin | 用户未登录 |
| ResourceNotFound | 资源不存在 |
| ResourceNotFound.Flow | 签署流程未找到 |
| UnauthorizedOperation.NoPermissionFeature | 请升级到对应版本后使用 |

---

## 六、调用流程

```
┌─────────────────────┐
│  发起合同流程        │  先通过 CreateFlow 等接口发起合同
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ CreateFlowSignUrl   │  生成H5签署链接
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│  返回签署链接        │  链接有效期30分钟
└─────────────────────┘
```

---

*文档来源：[腾讯电子签开发者文档](https://qian.tencent.com/developers/companyApis/startFlows/CreateFlowSignUrl/)*

*Content was rephrased for compliance with licensing restrictions*
